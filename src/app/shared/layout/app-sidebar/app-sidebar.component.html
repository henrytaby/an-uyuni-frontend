<aside
  class="fixed flex flex-col top-0 px-5 left-0 bg-white dark:bg-gray-900 dark:border-gray-800 text-gray-900 h-screen transition-all duration-300 ease-in-out z-50 border-r border-gray-200"
  [ngClass]="{
    'w-(--sidebar-width)': isVisible(),
    'w-(--sidebar-collapsed-width)': !isVisible(),
    'translate-x-0': isMobileOpen(),
    '-translate-x-full': !isMobileOpen(),
    'xl:translate-x-0': true
  }" (mouseenter)="onSidebarMouseEnter()" (mouseleave)="sidebarService.setHovered(false)">
  <div class="py-2 flex" [ngClass]="{
      'xl:justify-center': !isVisible(),
      'justify-start': isVisible()
    }">
    <a routerLink="/">
      @if (isVisible()) {
      <img class="dark:hidden" src="/images/bolivia/bolivia-aduana-nacional-01.png" alt="Logo" width="200"
        height="52" />
      <img class="hidden dark:block" src="/images/bolivia/bolivia-aduana-nacional-02.png" alt="Logo" width="200"
        height="52" />
      } @else {
      <img src="/images/logo/logo-icon.svg" alt="Logo" width="45" height="45" />
      }
    </a>
  </div>

  <div class="flex-1 flex flex-col overflow-y-auto duration-300 ease-linear"
    [ngClass]="isVisible() ? 'custom-scrollbar' : 'no-scrollbar'">
    <nav class="mb-6">
      <div class="flex flex-col gap-4">
        <!-- Menu Section -->
        <div>
          <h2 class="mb-4 text-xs uppercase flex leading-[20px] text-gray-400" [ngClass]="{
              'xl:justify-center': !isVisible(),
              'justify-start': isVisible()
            }">
            @if (isVisible())
            { Men√∫ }
            @else {
            <i class="pi pi-ellipsis-h text-xl"></i>
            }
          </h2>
          <ul class="flex flex-col gap-1">
            @for (nav of navItems(); track $index;let i = $index) {
            <li>
              @if (nav.subItems) {
              <button (click)="toggleSubmenu('main',i)" class="menu-item group cursor-pointer"
                [class.menu-item-active]="openSubmenu() === 'main-' + i"
                [class.menu-item-inactive]="openSubmenu() !== 'main-' + i" [ngClass]="{
                    'xl:justify-center': !isVisible(),
                    'xl:justify-start': isVisible()
                  }">
                <span class="menu-item-icon-size" [class.menu-item-icon-active]="openSubmenu() === 'main-' + i"
                  [class.menu-item-icon-inactive]="openSubmenu() !== 'main-' + i">
                  <i [class]="nav.icon"></i>
                </span>
                @if (isVisible()) {
                <span class="menu-item-text">
                  {{ nav.name }}
                </span>
                }
                @if (nav.new && isVisible()) {
                <span class="ml-auto absolute right-10 menu-dropdown-badge" [ngClass]="{
                      'menu-dropdown-badge-active': openSubmenu() === 'main-' + i,
                      'menu-dropdown-badge-inactive': openSubmenu() !== 'main-' + i
                    }">
                  nuevo
                </span>
                }
                @if (isVisible()) {
                <i class="pi pi-chevron-down ml-auto transition-transform duration-200" [ngClass]="{
                      'rotate-180 text-brand-500': openSubmenu() === 'main-' + i
                    }"></i>
                }
              </button>
              <div class="overflow-hidden transition-all duration-300" [id]="'main-' + i" [style.display]="
                    isVisible() ? 'block' : 'none'
                  " [ngStyle]="{
                    height:
                      openSubmenu() === 'main-' + i
                        ? (subMenuHeights()['main-' + i] || 0) + 'px'
                        : '0px'
                  }">
                <ul class="mt-2 space-y-1 ml-9">
                  @for (subItem of nav.subItems; track $index) {
                  <li>
                    <a [routerLink]="subItem.path" routerLinkActive="" (click)="onSubmenuClick()"
                      class="menu-dropdown-item" [ngClass]="{
                              'menu-dropdown-item-inactive': !isActive(subItem.path),
                              'menu-dropdown-item-active': isActive(subItem.path),
                            }">
                      @if (subItem.icon) {
                      <i [class]="subItem.icon" class="mr-2 text-lg"></i>
                      }
                      {{ subItem.name }}
                      <span class="flex items-center gap-1 ml-auto">
                        @if (subItem.new) {
                        <span class="menu-dropdown-badge" [ngClass]="{
                              'menu-dropdown-badge-active': isActive(subItem.path),
                              'menu-dropdown-badge-inactive': !isActive(subItem.path)
                            }">
                          nuevo
                        </span>
                        }
                        @if (subItem.pro) {
                        <span class="ml-auto menu-dropdown-badge-pro" [ngClass]="{
                              'menu-dropdown-badge-pro-active': isActive(subItem.path),
                              'menu-dropdown-badge-pro-inactive': !isActive(subItem.path)
                            }">
                          pro
                        </span>
                        }
                      </span>
                    </a>
                  </li>
                  }
                </ul>
              </div>
              } @else {
              @if (nav.path) {
              <a [routerLink]="nav.path" routerLinkActive="menu-item-active"
                [routerLinkActiveOptions]="{ exact: nav.path === '/' }" class="menu-item group"
                [ngClass]="{ 'menu-item-inactive': !isActive(nav.path) }">
                <span class="menu-item-icon-size" [ngClass]="{
                      'menu-item-icon-active': isActive(nav.path),
                      'menu-item-icon-inactive': !isActive(nav.path)
                    }">
                  <i [class]="nav.icon"></i>
                </span>
                <span class="menu-item-text">
                  @if (isVisible()) {
                  {{ nav.name }}
                  }
                </span>
              </a>
              }
              }
            </li>
            }
          </ul>
        </div>

        <!-- Others Section -->
        <div>
          <h2 class="mb-4 text-xs uppercase flex leading-[20px] text-gray-400" [ngClass]="{
              'xl:justify-center': !isVisible(),
              'justify-start': isVisible()
            }">
            @if (isVisible())
            { Otros }
            @else {
            <i class="pi pi-ellipsis-h text-xl"></i>
            }
          </h2>

          <ul class="flex flex-col gap-1">
            @for (nav of othersItems; track $index;let i = $index) {
            <li>
              @if (nav.subItems) {
              <button (click)="toggleSubmenu('others',i)" class="menu-item group cursor-pointer" [ngClass]="{
                     'menu-item-active': openSubmenu() === 'others-' + i,
                     'menu-item-inactive': openSubmenu() !== 'others-' + i,
                    'xl:justify-center': !isVisible(),
                    'xl:justify-start': isVisible()
                  }">
                <span class="menu-item-icon-size" [ngClass]="{
                      'menu-item-icon-active': openSubmenu() === 'others-' + i,
                      'menu-item-icon-inactive': openSubmenu() !== 'others-' + i
                    }">
                  <i [class]="nav.icon"></i>
                </span>
                @if (isVisible()) {
                <span class="menu-item-text">
                  {{ nav.name }}
                </span>
                }
                @if (nav.new && isVisible()) {
                <span class="ml-auto absolute right-10 menu-dropdown-badge" [ngClass]="{
                      'menu-dropdown-badge-active': openSubmenu() === 'others-' + i,
                      'menu-dropdown-badge-inactive': openSubmenu() !== 'others-' + i
                    }">
                  nuevo
                </span>
                }
                @if (isVisible()) {
                <i class="pi pi-chevron-down ml-auto transition-transform duration-200" [ngClass]="{
                      'rotate-180 text-brand-500': openSubmenu() === 'others-' + i
                    }"></i>
                }
              </button>
              <div class="overflow-hidden transition-all duration-300" [id]="'others-' + i" [style.display]="
                    isVisible() ? 'block' : 'none'
                  " [ngStyle]="{
                    height:
                      openSubmenu() === 'others-' + i
                        ? (subMenuHeights()['others-' + i] || 0) + 'px'
                        : '0px'
                  }">
                <ul class="mt-2 space-y-1 ml-9">
                  @for (subItem of nav.subItems; track $index) {
                  <li>
                    <a [routerLink]="subItem.path" routerLinkActive="" (click)="onSubmenuClick()"
                      class="menu-dropdown-item" [ngClass]="{
                              'menu-dropdown-item-inactive': !isActive(subItem.path),
                              'menu-dropdown-item-active': isActive(subItem.path),
                            }">
                      {{ subItem.name }}
                      <span class="flex items-center gap-1 ml-auto">
                        @if (subItem.new) {
                        <span class="menu-dropdown-badge" [ngClass]="{
                              'menu-dropdown-badge-active': isActive(subItem.path),
                              'menu-dropdown-badge-inactive': !isActive(subItem.path)
                            }">
                          nuevo
                        </span>
                        }
                        @if (subItem.pro) {
                        <span class="ml-auto menu-dropdown-badge-pro" [ngClass]="{
                              'menu-dropdown-badge-pro-active': isActive(subItem.path),
                              'menu-dropdown-badge-pro-inactive': !isActive(subItem.path)
                            }">
                          pro
                        </span>
                        }
                      </span>
                    </a>
                  </li>
                  }
                </ul>
              </div>
              } @else {
              @if (nav.path) {
              <a [routerLink]="nav.path" routerLinkActive="menu-item-active" class="menu-item group"
                [ngClass]="{ 'menu-item-inactive': !isActive(nav.path) }">
                <span class="menu-item-icon-size" [ngClass]="{
                      'menu-item-icon-active': isActive(nav.path),
                      'menu-item-icon-inactive': !isActive(nav.path)
                    }">
                  <i [class]="nav.icon"></i>
                </span>
                <span class="menu-item-text">
                  @if (isVisible()) {
                  {{ nav.name }}
                  }
                </span>
              </a>
              }
              }
            </li>
            }
          </ul>
        </div>
      </div>
    </nav>
  </div>
</aside>