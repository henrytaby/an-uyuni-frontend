<div class="relative">
  <button (click)="toggleDropdown()" class="flex items-center text-gray-700 dropdown-toggle dark:text-gray-400">
    <div
      class="mr-3 flex items-center justify-center rounded-full h-11 w-11 bg-theme-primary/10 text-theme-primary border border-theme-primary/20">
      <span class="font-bold text-lg">{{ userInitials() }}</span>
    </div>
    <span class="block mr-1 font-medium text-theme-sm">{{ currentUser()?.first_name }} {{ currentUser()?.last_name
      }}</span>
    <i class="pi transition-transform duration-200" [class.pi-chevron-down]="!isOpen()" [class.pi-chevron-up]="isOpen()"
      [class.rotate-180]="isOpen()"></i>
  </button>

  <app-dropdown [isOpen]="isOpen()" (closeDropdown)="closeDropdown()"
    className="absolute right-0 mt-[17px] flex w-[260px] flex-col rounded-2xl border border-gray-200/50 bg-white/90 backdrop-blur-xl p-3 shadow-theme-lg dark:border-gray-800/50 dark:bg-gray-900/90 animate-dropdown-in">
    <div>
      <span class="block font-medium text-gray-700 text-theme-sm dark:text-gray-400">
        {{ currentUser()?.first_name }} {{ currentUser()?.last_name }}
      </span>
      <span class="mt-0.5 block text-theme-xs text-gray-500 dark:text-gray-400">
        {{ currentUser()?.email }}
      </span>
    </div>

    <ul class="flex flex-col gap-1 pb-3 pt-4 border-b border-gray-200 dark:border-gray-800">
      <li>
        <app-dropdown-item (itemClick)="closeDropdown()" [to]="'/profile'"
          className="flex w-full items-center gap-3 px-3 py-2 font-medium text-gray-700 rounded-lg group text-theme-sm hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-white/5 dark:hover:text-gray-300">
          <i
            class="pi pi-user text-lg text-gray-500 group-hover:text-gray-700 dark:text-gray-400 dark:group-hover:text-gray-300"></i>
          Editar perfil
        </app-dropdown-item>
      </li>
      <li>
        <app-dropdown-item (itemClick)="closeDropdown()" [to]="'/profile'"
          className="flex w-full items-center gap-3 px-3 py-2 font-medium text-gray-700 rounded-lg group text-theme-sm hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-white/5 dark:hover:text-gray-300">
          <i
            class="pi pi-cog text-lg text-gray-500 group-hover:text-gray-700 dark:text-gray-400 dark:group-hover:text-gray-300"></i>
          Configuración de cuenta
        </app-dropdown-item>
      </li>
      <li>
        <app-dropdown-item (itemClick)="closeDropdown()" [to]="'/profile'"
          className="flex w-full items-center gap-3 px-3 py-2 font-medium text-gray-700 rounded-lg group text-theme-sm hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-white/5 dark:hover:text-gray-300">
          <i
            class="pi pi-question-circle text-lg text-gray-500 group-hover:text-gray-700 dark:text-gray-400 dark:group-hover:text-gray-300"></i>
          Soporte
        </app-dropdown-item>
      </li>
    </ul>
    <app-dropdown-item (click)="handleLogout()"
      className="flex w-full items-center gap-3 px-3 py-2 mt-3 font-medium text-gray-700 rounded-lg group text-theme-sm hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-white/5 dark:hover:text-gray-300">
      <i class="pi pi-sign-out text-lg text-gray-500 group-hover:text-gray-700 dark:group-hover:text-gray-300"></i>
      Cerrar sesión
    </app-dropdown-item>
  </app-dropdown>
</div>